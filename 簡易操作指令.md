# 簡易操作指令

以下列出啟動與操作專案的最常用指令與注意事項。若剛接觸專案，請照步驟執行即可完成基本流程。必要時分別列出 **Windows PowerShell** 與 **macOS / Linux (zsh)** 的指令差異。

## 1. 取得專案原始碼

```powershell
# Windows PowerShell
 git clone git@github.com:DDChen666/MTC-Flow-An-Experimentation-Engine-for-Multi-Task-Classification.git
 cd MTC-Flow-An-Experimentation-Engine-for-Multi-Task-Classification
```
```bash
# macOS / Linux (zsh)
 git clone git@github.com:DDChen666/MTC-Flow-An-Experimentation-Engine-for-Multi-Task-Classification.git
 cd MTC-Flow-An-Experimentation-Engine-for-Multi-Task-Classification
```

> **細節檢查**：確保已設定 SSH key，可正確連線到 GitHub；若沒有權限可改用 HTTPS URL。

## 2. 建立並啟動虛擬環境

```powershell
# Windows PowerShell
python -m venv venv
.\venv\Scripts\Activate.ps1
```
```bash
# macOS / Linux (zsh)
python3 -m venv venv
source venv/bin/activate
```

> **細節檢查**：執行 `python --version` 或 `python3 --version`，確認為 3.9 以上版本。啟用 venv 後，命令列前方會出現 `(venv)` 標記。

## 3. 安裝專案依賴

```powershell
pip install --upgrade pip
pip install -e .
```

> **延伸用法**：若只想安裝必要依賴，可選擇 `pip install -e .[develop]` 取得開發工具（black、ruff 等）。

## 4. 準備資料集

1. 預設資料位置：`input_train_and_test_json/`
2. 確保該資料夾內有 `train_set_*.json` 與 `test_set_*.json`
3. 欄位名稱需符合 `configs/default.yaml` 中 `data.text_field`、`data.primary_field`、`data.secondary_field`

> **延伸用法**：若要用其他資料夾，修改設定檔 `data.root_dir`，或啟用 `split` stage 自動產生 train/test。

## 5. 先檢視可用的 pipeline stage

```powershell
python -m src.main --config configs/default.yaml --list-stages
```

顯示結果：`split`, `train`, `tune`, `stability`。只有 `enabled: true` 的 stage 會執行。

## 6. 執行基本訓練流程

```powershell
python -m src.main --config configs/default.yaml --stages train
```

> **延伸用法**：
> - 執行整套流程（按照設定檔 `pipeline.stages` 順序）：
>   ```powershell
>   python -m src.main --config configs/default.yaml
>   ```
> - 只跑資料切分與訓練：
>   ```powershell
>   python -m src.main --config configs/default.yaml --stages split train
>   ```

## 7. 查看輸出結果

- 訓練結果：`artifacts/training/<timestamp>/`
- 超參數搜尋：`artifacts/tuning/`
- 穩定度測試：`artifacts/stability/`
- 日誌檔案：`artifacts/pipeline.log`

> **細節檢查**：若找不到輸出，確認 stage 是否啟用、資料路徑是否正確，以及程式有無報錯。

## 8. 常用驗證指令

- 檢查設定檔是否能正確解析：
  ```powershell
  python -c "from src.utils.config import load_project_config; load_project_config('configs/default.yaml')"
  ```
- 測試 CLI wrapper（兼容舊腳本習慣）：
  ```powershell
  python train_mtc.py --config configs/default.yaml
  python optuna_tune.py --config configs/default.yaml
  python eval_stability.py --config configs/default.yaml
  ```

## 9. Git 操作（可選，但建議）

```powershell
git status
git add <檔案>
git commit -m "描述修改"
git push origin <branch>
```

> **細節檢查**：避免將大型資料或輸出結果加入版本控制；`.gitignore` 已預設忽略 venv、artifacts、資料集。

## 10. 附錄：常見延伸指令

| 需求 | 指令 | 備註 |
|------|------|------|
| 啟用資料切分 | `python -m src.main --config configs/default.yaml --stages split` | 需先設定 `data.split.enabled: true` 及 `split.input_path` |
| 執行超參數搜尋 | `python -m src.main --config configs/default.yaml --stages tune` | 需安裝 `optuna`；結果會匯出 JSON + CSV |
| 重複訓練檢查穩定度 | `python -m src.main --config configs/default.yaml --stages stability` | 可調整 `stability.runs` 與 `base_seed` |
| 使用自訂設定檔 | `python -m src.main --config configs/my-config.yaml --stages train` | 複製 default.yaml 再修改 |
| 重新安裝依賴 | `pip install --upgrade -r requirements.txt`（若另有凍結檔） | 可搭配 `pip freeze > requirements.txt` 產生 |

照此流程操作即可完成專案初始化與基礎訓練。更多進階教學請參考《超詳細專案教學.md》或 README 的延伸章節。
